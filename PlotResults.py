import cPickle

import numpy             as np
import numpy.random      as rd
import scipy.stats       as st
import scipy.special     as sp
import matplotlib.pyplot as plt

# Results with K = 10 and using movie scores:

results = np.array([
[
[26, 8170.313285, 814.451463],
[28, 9378.823016, 839.529246],
[30, 9096.550174, 901.069867],
[32, 9494.062049, 1079.569199],
[34, 9230.643552, 913.513080],
[36, 7707.866227, 785.381336],
[38, 8384.193477, 997.368068],
[40, 8215.372294, 886.358621],
],
[
[26, 6949.960455, 748.117621],
[28, 6670.439137, 752.810392],
[30, 5782.187867, 606.316171],
[32, 6025.803015, 712.715226],
[34, 6410.813179, 696.482062],
[36, 6101.110817, 680.224139],
[38, 4945.753040, 638.723747],
[40, 5663.154504, 665.481441],
],
[
[26, 7007.008566, 839.760085],
[28, 7318.718106, 813.923733],
[30, 7519.240408, 959.371406],
[32, 7541.438891, 939.495846],
[34, 6361.941359, 830.360335],
[36, 7172.031358, 959.199889],
[38, 6747.798510, 814.491009],
[40, 6548.898075, 941.237049],
],
[
[26, 6819.542565, 772.376931],
[28, 6480.005328, 725.033185],
[30, 6061.833758, 685.024537],
[32, 6264.335994, 668.283975],
[34, 5667.334473, 744.265483],
[36, 5951.102774, 636.091095],
[38, 6686.851862, 771.886701],
[40, 5984.768294, 722.595052],
],
[
[26, 8914.580814, 1004.362080],
[28, 8818.038272, 875.517292],
[30, 7541.287731, 924.588241],
[32, 9583.568560, 943.958342],
[34, 8759.509867, 886.709948],
[36, 7796.842987, 833.595379],
[38, 7303.747532, 807.028792],
[40, 7560.419228, 820.772225],   
],
[
[26, 4685.041520, 777.844380],
[28, 6116.620706, 704.740004],
[30, 7091.001280, 745.354517],
[32, 6995.859069, 764.375941],
[34, 7346.089472, 788.897102],
[36, 6908.120697, 868.823385],
[38, 6802.244609, 762.634426],
[40, 8076.795483, 825.113294],
],
])

plt.figure(figsize = (16.0 / 2, 9.0 / 2))
plt.title("Perplexity")
plt.hold(True)
for c in range(results.shape[0]):
    plt.plot(results[c, :, 0].flatten(), results[c, :, 1].flatten(), color = "black")
plt.plot(results[c, :, 0].flatten(), np.mean(results[:, :, 1], axis = 0).flatten(), color = "black", linewidth = 5)
plt.savefig("results_perplexity.png")

plt.figure(figsize = (16.0 / 2, 9.0 / 2))
plt.title("Inverse accuracy")
plt.hold(True)
for c in range(results.shape[0]):
    plt.plot(results[c, :, 0].flatten(), results[c, :, 2].flatten(), color = "black")
plt.plot(results[c, :, 0].flatten(), np.mean(results[:, :, 2], axis = 0).flatten(), color = "black", linewidth = 5)
plt.savefig("results_accuracy.png")

#plt.show()